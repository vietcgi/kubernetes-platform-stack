{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "title": "Platform Library Helm Chart Schema",
  "description": "Schema for validating platform-library shared templates and defaults",
  "type": "object",
  "properties": {
    "global": {
      "type": "object",
      "description": "Global configuration shared across all releases",
      "properties": {
        "domain": {
          "type": "string",
          "description": "Base domain for services",
          "default": "platform.local"
        },
        "environment": {
          "type": "string",
          "description": "Deployment environment (development, staging, production)",
          "enum": ["development", "staging", "production"],
          "default": "development"
        },
        "imagePullPolicy": {
          "type": "string",
          "description": "Default image pull policy",
          "enum": ["IfNotPresent", "Always", "Never"],
          "default": "IfNotPresent"
        },
        "registryUrl": {
          "type": "string",
          "description": "Docker registry URL for image pulls",
          "format": "hostname",
          "default": "docker.io"
        }
      }
    },
    "networkPolicy": {
      "type": "object",
      "description": "Network policy defaults",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable network policies",
          "default": true
        },
        "policyTypes": {
          "type": "array",
          "description": "Policy types (Ingress, Egress)",
          "items": {
            "type": "string",
            "enum": ["Ingress", "Egress"]
          },
          "default": ["Ingress", "Egress"]
        },
        "defaultDeny": {
          "type": "boolean",
          "description": "Default deny all traffic pattern",
          "default": true
        }
      }
    },
    "securityContext": {
      "type": "object",
      "description": "Default security context for all pods",
      "properties": {
        "runAsNonRoot": {
          "type": "boolean",
          "description": "Run containers as non-root",
          "default": true
        },
        "runAsUser": {
          "type": "integer",
          "description": "Default UID for containers",
          "minimum": 0,
          "default": 1000
        },
        "fsGroup": {
          "type": "integer",
          "description": "Default GID for volumes",
          "minimum": 0,
          "default": 1000
        },
        "readOnlyRootFilesystem": {
          "type": "boolean",
          "description": "Mount root filesystem as read-only",
          "default": true
        },
        "allowPrivilegeEscalation": {
          "type": "boolean",
          "description": "Allow privilege escalation",
          "default": false
        }
      }
    },
    "resources": {
      "type": "object",
      "description": "Default resource limits and requests",
      "properties": {
        "small": {
          "type": "object",
          "description": "Small workload resource defaults",
          "properties": {
            "requests": {
              "type": "object",
              "properties": {
                "cpu": {
                  "type": "string",
                  "default": "50m"
                },
                "memory": {
                  "type": "string",
                  "default": "64Mi"
                }
              }
            },
            "limits": {
              "type": "object",
              "properties": {
                "cpu": {
                  "type": "string",
                  "default": "100m"
                },
                "memory": {
                  "type": "string",
                  "default": "256Mi"
                }
              }
            }
          }
        },
        "medium": {
          "type": "object",
          "description": "Medium workload resource defaults",
          "properties": {
            "requests": {
              "type": "object",
              "properties": {
                "cpu": {
                  "type": "string",
                  "default": "100m"
                },
                "memory": {
                  "type": "string",
                  "default": "128Mi"
                }
              }
            },
            "limits": {
              "type": "object",
              "properties": {
                "cpu": {
                  "type": "string",
                  "default": "500m"
                },
                "memory": {
                  "type": "string",
                  "default": "512Mi"
                }
              }
            }
          }
        },
        "large": {
          "type": "object",
          "description": "Large workload resource defaults",
          "properties": {
            "requests": {
              "type": "object",
              "properties": {
                "cpu": {
                  "type": "string",
                  "default": "500m"
                },
                "memory": {
                  "type": "string",
                  "default": "512Mi"
                }
              }
            },
            "limits": {
              "type": "object",
              "properties": {
                "cpu": {
                  "type": "string",
                  "default": "1"
                },
                "memory": {
                  "type": "string",
                  "default": "1Gi"
                }
              }
            }
          }
        }
      }
    },
    "probe": {
      "type": "object",
      "description": "Default health probe configuration",
      "properties": {
        "liveness": {
          "type": "object",
          "properties": {
            "initialDelaySeconds": {
              "type": "integer",
              "default": 30
            },
            "periodSeconds": {
              "type": "integer",
              "default": 10
            },
            "timeoutSeconds": {
              "type": "integer",
              "default": 5
            },
            "failureThreshold": {
              "type": "integer",
              "default": 3
            }
          }
        },
        "readiness": {
          "type": "object",
          "properties": {
            "initialDelaySeconds": {
              "type": "integer",
              "default": 5
            },
            "periodSeconds": {
              "type": "integer",
              "default": 5
            },
            "timeoutSeconds": {
              "type": "integer",
              "default": 3
            },
            "failureThreshold": {
              "type": "integer",
              "default": 3
            }
          }
        }
      }
    },
    "labels": {
      "type": "object",
      "description": "Default labels applied to all resources",
      "additionalProperties": {
        "type": "string"
      }
    },
    "annotations": {
      "type": "object",
      "description": "Default annotations applied to all resources",
      "additionalProperties": {
        "type": "string"
      }
    }
  },
  "additionalProperties": true
}
