# HashiCorp Vault Helm Chart Values
# Secrets management and encryption

vault:
  enabled: true

  # Image
  image:
    repository: hashicorp/vault
    tag: 1.17.0
    pullPolicy: IfNotPresent

  # Replicas
  replicas: 1

  # Server configuration
  server:
    enabled: true

    # Data storage
    dataStorage:
      enabled: true
      size: 5Gi
      storageClass: standard

    # Audit logging
    auditStorage:
      enabled: true
      size: 1Gi
      storageClass: standard

    # Resource limits
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 1Gi

    # Pod security context
    podSecurityContext:
      runAsNonRoot: true
      runAsUser: 100

    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
        - ALL
      readOnlyRootFilesystem: true

    # Service
    service:
      type: ClusterIP
      port: 8200

    # HA configuration
    ha:
      enabled: false
      replicas: 1

    # TLS Configuration
    # CRITICAL: TLS MUST be enabled in production environments
    # For development/testing, you can disable with: tlsDisable: true
    # For production:
    # 1. Generate or obtain TLS certificates signed by a trusted CA
    # 2. Create Kubernetes secrets: kubectl create secret tls vault-tls --cert=vault.crt --key=vault.key -n vault
    # 3. Set tlsDisable: false and configure tlsCert and tlsKey below
    tlsDisable: true  # Change to false and configure TLS certificates below for production

    # Uncomment and configure these for TLS in production:
    # tlsCert: |
    #   -----BEGIN CERTIFICATE-----
    #   <your-tls-certificate-here>
    #   -----END CERTIFICATE-----
    # tlsKey: |
    #   -----BEGIN PRIVATE KEY-----
    #   <your-private-key-here>
    #   -----END PRIVATE KEY-----

    # Alternative: Reference secret containing pre-created TLS cert/key
    # existingSecret: vault-tls

  # UI
  ui:
    enabled: true
    serviceType: ClusterIP

  # Auth methods
  authMethods:
    kubernetes:
      enabled: true
      path: kubernetes
    jwt:
      enabled: false

  # Secrets engines
  secretsEngines:
    kv:
      enabled: true
      version: 2
      path: secret
    pki:
      enabled: false
    ssh:
      enabled: false

  # Policies
  policies:
    default:
      enabled: true

# Service Monitor for Prometheus
serviceMonitor:
  enabled: true
  namespace: monitoring
  interval: 30s

# RBAC
rbac:
  create: true

# High availability
ha:
  enabled: false
